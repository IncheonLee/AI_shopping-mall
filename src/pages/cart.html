<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>장바구니 - 쇼핑몰</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .cart-container {
            padding: 60px 0;
        }
        
        .cart-header {
            margin-bottom: 30px;
        }
        
        .cart-header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            color: var(--dark-color);
        }
        
        .breadcrumb {
            display: flex;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .breadcrumb a {
            color: var(--grey-color);
        }
        
        .breadcrumb span {
            margin: 0 8px;
            color: var(--grey-color);
        }
        
        .cart-empty {
            text-align: center;
            padding: 60px 0;
        }
        
        .cart-empty i {
            font-size: 64px;
            color: var(--light-grey-color);
            margin-bottom: 20px;
        }
        
        .cart-empty h2 {
            font-size: 24px;
            margin-bottom: 15px;
            color: var(--dark-color);
        }
        
        .cart-empty p {
            font-size: 16px;
            color: var(--grey-color);
            margin-bottom: 30px;
        }
        
        .btn-continue-shopping {
            display: inline-block;
            padding: 12px 25px;
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--border-radius);
            font-weight: 500;
            transition: var(--transition);
        }
        
        .btn-continue-shopping:hover {
            background-color: var(--dark-color);
        }
        
        .cart-content {
            display: flex;
            gap: 30px;
        }
        
        .cart-items {
            flex: 1;
        }
        
        .cart-summary {
            width: 350px;
        }
        
        .cart-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .cart-table th {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--light-grey-color);
            font-weight: 500;
        }
        
        .cart-table td {
            padding: 15px;
            border-bottom: 1px solid var(--light-grey-color);
        }
        
        .cart-product {
            display: flex;
            align-items: center;
        }
        
        .cart-product-image {
            width: 80px;
            height: 80px;
            margin-right: 15px;
        }
        
        .cart-product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: var(--border-radius);
        }
        
        .cart-product-info h3 {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .cart-product-info p {
            font-size: 14px;
            color: var(--grey-color);
        }
        
        .cart-quantity {
            display: flex;
            align-items: center;
        }
        
        .quantity-input {
            width: 50px;
            height: 36px;
            text-align: center;
            border: 1px solid var(--light-grey-color);
            border-radius: var(--border-radius);
            margin: 0 5px;
        }
        
        .quantity-btn {
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--light-grey-color);
            border-radius: 50%;
            background-color: white;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .quantity-btn:hover {
            background-color: var(--light-color);
        }
        
        .cart-price {
            font-weight: 500;
            color: var(--primary-color);
        }
        
        .cart-remove {
            color: var(--grey-color);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .cart-remove:hover {
            color: var(--error-color);
        }
        
        .cart-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .btn-update-cart {
            padding: 10px 20px;
            background-color: transparent;
            border: 1px solid var(--light-grey-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: var(--transition);
        }
        
        .btn-update-cart:hover {
            background-color: var(--light-color);
        }
        
        .btn-clear-cart {
            padding: 10px 20px;
            background-color: transparent;
            border: 1px solid var(--light-grey-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            color: var(--error-color);
            transition: var(--transition);
        }
        
        .btn-clear-cart:hover {
            background-color: var(--error-color);
            color: white;
            border-color: var(--error-color);
        }
        
        .summary-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
        }
        
        .summary-title {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-grey-color);
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .summary-label {
            color: var(--grey-color);
        }
        
        .summary-value {
            font-weight: 500;
        }
        
        .summary-total {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .coupon-form {
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .coupon-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--light-grey-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .btn-apply-coupon {
            width: 100%;
            padding: 12px;
            background-color: var(--dark-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .btn-apply-coupon:hover {
            background-color: #000;
        }
        
        .btn-checkout {
            width: 100%;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 20px;
            transition: var(--transition);
        }
        
        .btn-checkout:hover {
            background-color: #303f9f;
        }
        
        .payment-methods {
            margin-top: 20px;
            text-align: center;
        }
        
        .payment-methods p {
            font-size: 14px;
            color: var(--grey-color);
            margin-bottom: 10px;
        }
        
        .payment-icons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        .payment-icon {
            font-size: 24px;
            color: var(--grey-color);
        }
        
        @media (max-width: 992px) {
            .cart-content {
                flex-direction: column;
            }
            
            .cart-summary {
                width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .cart-table thead {
                display: none;
            }
            
            .cart-table tbody tr {
                display: block;
                padding: 15px 0;
            }
            
            .cart-table td {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 10px 0;
                border: none;
            }
            
            .cart-table td::before {
                content: attr(data-label);
                font-weight: 500;
            }
            
            .cart-product {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .cart-product-image {
                margin-right: 0;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-top">
                <div class="logo">
                    <a href="../../index.html">
                        <h1>쇼핑몰</h1>
                    </a>
                </div>
                <div class="search-bar">
                    <form action="#" method="get">
                        <input type="text" placeholder="검색어를 입력하세요...">
                        <button type="submit"><i class="fas fa-search"></i></button>
                    </form>
                </div>
                <div class="header-actions">
                    <a href="login.html" class="btn-login">로그인</a>
                    <a href="register.html" class="btn-register">회원가입</a>
                    <a href="cart.html" class="btn-cart">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count">0</span>
                    </a>
                </div>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="../../index.html">홈</a></li>
                    <li><a href="products.html?category=all">전체상품</a></li>
                    <li><a href="products.html?category=new">신상품</a></li>
                    <li><a href="products.html?category=best">베스트</a></li>
                    <li><a href="products.html?category=sale">할인상품</a></li>
                    <li><a href="customer-service.html">고객센터</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="cart-container">
                <div class="cart-header">
                    <div class="breadcrumb">
                        <a href="../../index.html">홈</a>
                        <span>/</span>
                        <a href="cart.html">장바구니</a>
                    </div>
                    <h1>장바구니</h1>
                </div>
                
                <!-- 장바구니가 비어있을 때 표시 -->
                <div class="cart-empty" style="display: none;">
                    <i class="fas fa-shopping-cart"></i>
                    <h2>장바구니가 비어있습니다</h2>
                    <p>원하는 상품을 장바구니에 담아보세요!</p>
                    <a href="products.html?category=all" class="btn-continue-shopping">쇼핑 계속하기</a>
                </div>
                
                <!-- 장바구니에 상품이 있을 때 표시 -->
                <div class="cart-content">
                    <div class="cart-items">
                        <table class="cart-table">
                            <thead>
                                <tr>
                                    <th>상품</th>
                                    <th>가격</th>
                                    <th>수량</th>
                                    <th>합계</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="cart-items-container">
                                <!-- 장바구니 아이템은 JavaScript로 동적 생성 -->
                            </tbody>
                        </table>
                        
                        <div class="cart-actions">
                            <button class="btn-update-cart">장바구니 업데이트</button>
                            <button class="btn-clear-cart">장바구니 비우기</button>
                        </div>
                    </div>
                    
                    <div class="cart-summary">
                        <div class="summary-card">
                            <h2 class="summary-title">주문 요약</h2>
                            
                            <div class="summary-row">
                                <span class="summary-label">상품 금액</span>
                                <span class="summary-value" id="subtotal">0원</span>
                            </div>
                            
                            <div class="summary-row">
                                <span class="summary-label">배송비</span>
                                <span class="summary-value" id="shipping">3,000원</span>
                            </div>
                            
                            <div class="summary-row">
                                <span class="summary-label">할인 금액</span>
                                <span class="summary-value" id="discount">0원</span>
                            </div>
                            
                            <div class="summary-row">
                                <span class="summary-label">총 결제 금액</span>
                                <span class="summary-value summary-total" id="total">3,000원</span>
                            </div>
                            
                            <div class="coupon-form">
                                <input type="text" class="coupon-input" placeholder="쿠폰 코드 입력">
                                <button class="btn-apply-coupon">쿠폰 적용</button>
                            </div>
                            
                            <button class="btn-checkout">결제하기</button>
                            
                            <div class="payment-methods">
                                <p>결제 방법</p>
                                <div class="payment-icons">
                                    <i class="fab fa-cc-visa payment-icon"></i>
                                    <i class="fab fa-cc-mastercard payment-icon"></i>
                                    <i class="fab fa-cc-amex payment-icon"></i>
                                    <i class="fab fa-cc-paypal payment-icon"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>쇼핑몰</h3>
                    <p>최고의 제품을 합리적인 가격으로 제공하는 온라인 쇼핑몰입니다.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>쇼핑하기</h3>
                    <ul>
                        <li><a href="products.html?category=new">신상품</a></li>
                        <li><a href="products.html?category=best">베스트 상품</a></li>
                        <li><a href="products.html?category=sale">할인 상품</a></li>
                        <li><a href="products.html?category=all">전체 상품</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>고객 서비스</h3>
                    <ul>
                        <li><a href="contact.html">문의하기</a></li>
                        <li><a href="faq.html">자주 묻는 질문</a></li>
                        <li><a href="shipping.html">배송 정보</a></li>
                        <li><a href="returns.html">교환 및 반품</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>내 계정</h3>
                    <ul>
                        <li><a href="login.html">로그인</a></li>
                        <li><a href="register.html">회원가입</a></li>
                        <li><a href="orders.html">주문 조회</a></li>
                        <li><a href="wishlist.html">위시리스트</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 쇼핑몰. All Rights Reserved.</p>
                <div class="footer-links">
                    <a href="privacy.html">개인정보처리방침</a>
                    <a href="terms.html">이용약관</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="../assets/js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 로컬 스토리지에서 장바구니 데이터 가져오기
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            const cartItemsContainer = document.getElementById('cart-items-container');
            const cartEmptySection = document.querySelector('.cart-empty');
            const cartContentSection = document.querySelector('.cart-content');
            const subtotalElement = document.getElementById('subtotal');
            const shippingElement = document.getElementById('shipping');
            const discountElement = document.getElementById('discount');
            const totalElement = document.getElementById('total');
            const cartCountElement = document.querySelector('.cart-count');
            
            // 장바구니 상태에 따라 UI 업데이트
            if (cartItems.length === 0) {
                cartEmptySection.style.display = 'block';
                cartContentSection.style.display = 'none';
                cartCountElement.textContent = '0';
            } else {
                cartEmptySection.style.display = 'none';
                cartContentSection.style.display = 'flex';
                cartCountElement.textContent = cartItems.length;
                renderCartItems();
            }
            
            // 장바구니 아이템 렌더링
            function renderCartItems() {
                cartItemsContainer.innerHTML = '';
                
                let subtotal = 0;
                
                cartItems.forEach((item, index) => {
                    const row = document.createElement('tr');
                    
                    // 가격 문자열에서 숫자만 추출
                    const price = parseInt(item.price.replace(/[^0-9]/g, ''));
                    const itemTotal = price * item.quantity;
                    subtotal += itemTotal;
                    
                    row.innerHTML = `
                        <td data-label="상품">
                            <div class="cart-product">
                                <div class="cart-product-image">
                                    <img src="${item.image}" alt="${item.name}">
                                </div>
                                <div class="cart-product-info">
                                    <h3>${item.name}</h3>
                                </div>
                            </div>
                        </td>
                        <td data-label="가격" class="cart-price">${price.toLocaleString()}원</td>
                        <td data-label="수량">
                            <div class="cart-quantity">
                                <button class="quantity-btn decrease" data-index="${index}">-</button>
                                <input type="number" class="quantity-input" value="${item.quantity}" min="1" data-index="${index}">
                                <button class="quantity-btn increase" data-index="${index}">+</button>
                            </div>
                        </td>
                        <td data-label="합계" class="cart-price">${itemTotal.toLocaleString()}원</td>
                        <td>
                            <i class="fas fa-times cart-remove" data-index="${index}"></i>
                        </td>
                    `;
                    
                    cartItemsContainer.appendChild(row);
                });
                
                // 금액 업데이트
                updateCartSummary(subtotal);
                
                // 이벤트 리스너 추가
                addCartEventListeners();
            }
            
            // 장바구니 요약 정보 업데이트
            function updateCartSummary(subtotal) {
                const shipping = subtotal > 0 ? 3000 : 0;
                const discount = 0; // 할인 금액 (쿠폰 적용 시 변경)
                const total = subtotal + shipping - discount;
                
                subtotalElement.textContent = subtotal.toLocaleString() + '원';
                shippingElement.textContent = shipping.toLocaleString() + '원';
                discountElement.textContent = discount.toLocaleString() + '원';
                totalElement.textContent = total.toLocaleString() + '원';
            }
            
            // 장바구니 이벤트 리스너 추가
            function addCartEventListeners() {
                // 수량 감소 버튼
                const decreaseButtons = document.querySelectorAll('.quantity-btn.decrease');
                decreaseButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        if (cartItems[index].quantity > 1) {
                            cartItems[index].quantity--;
                            updateCart();
                        }
                    });
                });
                
                // 수량 증가 버튼
                const increaseButtons = document.querySelectorAll('.quantity-btn.increase');
                increaseButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        cartItems[index].quantity++;
                        updateCart();
                    });
                });
                
                // 수량 입력 변경
                const quantityInputs = document.querySelectorAll('.quantity-input');
                quantityInputs.forEach(input => {
                    input.addEventListener('change', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        const newQuantity = parseInt(this.value);
                        
                        if (newQuantity > 0) {
                            cartItems[index].quantity = newQuantity;
                            updateCart();
                        } else {
                            this.value = cartItems[index].quantity;
                        }
                    });
                });
                
                // 상품 제거 버튼
                const removeButtons = document.querySelectorAll('.cart-remove');
                removeButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        cartItems.splice(index, 1);
                        updateCart();
                        
                        if (cartItems.length === 0) {
                            cartEmptySection.style.display = 'block';
                            cartContentSection.style.display = 'none';
                        }
                    });
                });
                
                // 장바구니 업데이트 버튼
                const updateCartButton = document.querySelector('.btn-update-cart');
                updateCartButton.addEventListener('click', function() {
                    showToast('장바구니가 업데이트되었습니다.');
                });
                
                // 장바구니 비우기 버튼
                const clearCartButton = document.querySelector('.btn-clear-cart');
                clearCartButton.addEventListener('click', function() {
                    if (confirm('장바구니를 비우시겠습니까?')) {
                        cartItems.length = 0;
                        localStorage.setItem('cartItems', JSON.stringify(cartItems));
                        cartEmptySection.style.display = 'block';
                        cartContentSection.style.display = 'none';
                        cartCountElement.textContent = '0';
                        showToast('장바구니가 비워졌습니다.');
                    }
                });
                
                // 쿠폰 적용 버튼
                const applyCouponButton = document.querySelector('.btn-apply-coupon');
                applyCouponButton.addEventListener('click', function() {
                    const couponInput = document.querySelector('.coupon-input');
                    const couponCode = couponInput.value.trim();
                    
                    if (couponCode) {
                        // 실제로는 서버에서 쿠폰 유효성 검사를 해야 함
                        // 쿠폰 코드 검증 로직 (실제 구현에서는 서버에서 처리)
                        if (couponCode && couponCode.length > 3) {
                            // 10% 할인 적용
                            const subtotal = parseInt(subtotalElement.textContent.replace(/[^0-9]/g, ''));
                            const discount = Math.floor(subtotal * 0.1);
                            discountElement.textContent = discount.toLocaleString() + '원';
                            
                            const shipping = parseInt(shippingElement.textContent.replace(/[^0-9]/g, ''));
                            const total = subtotal + shipping - discount;
                            totalElement.textContent = total.toLocaleString() + '원';
                            
                            showToast('쿠폰이 적용되었습니다.');
                            couponInput.value = '';
                        } else {
                            showToast('유효하지 않은 쿠폰 코드입니다.');
                        }
                    } else {
                        showToast('쿠폰 코드를 입력해주세요.');
                    }
                });
                
                // 결제하기 버튼
                const checkoutButton = document.querySelector('.btn-checkout');
                checkoutButton.addEventListener('click', function() {
                    // 실제로는 결제 페이지로 이동
                    showToast('결제 기능은 현재 준비 중입니다.');
                });
            }
            
            // 장바구니 업데이트
            function updateCart() {
                localStorage.setItem('cartItems', JSON.stringify(cartItems));
                renderCartItems();
                cartCountElement.textContent = cartItems.length;
            }
        });
    </script>
</body>
</html>
